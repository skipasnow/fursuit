<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Kemono Fursuit Makers</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Tabulator CSS -->
<link href="https://unpkg.com/tabulator-tables@5.5.0/dist/css/tabulator.min.css" rel="stylesheet">

<style>
  body {
    background: #2e2e2e;
    color: #fff;
    font-family: sans-serif;
    padding: 20px;
  }

  #creator-table {
    margin-top: 20px;
  }

  /* Hover image preview tooltip */
  .preview-hover {
    cursor: pointer;
    color: #00ffff;
    position: relative;
  }

  .preview-hover img {
    display: none;
    position: absolute;
    width: 250px;
    height: 250px;
    border: 2px solid #fff;
    z-index: 1000;
    top: 0;
    left: 105%;
  }
</style>
</head>
<body>

<h1>Kemono Fursuit Makers</h1>
<div id="creator-table"></div>

<!-- Dependencies -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
<script src="https://unpkg.com/tabulator-tables@5.5.0/dist/js/tabulator.min.js"></script>

<script>
const csvUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vQesC2Kuwk-4S3ID4cCsCvOGM4U0DstvIoewGKQn4pZII8mkoa6fxcN18ozOO3_EkISGIkKNVngLYdN/pub?gid=131139777&single=true&output=csv";

Papa.parse(csvUrl, {
  download: true,
  header: true,
  complete: function(results) {
    const data = results.data.filter(row => row.Maker); // remove empty rows

    if(!data.length) return;

    const columns = Object.keys(data[0]).map(colName => {
      if(colName === "Rank"){
        return {
          title: colName,
          field: colName,
          resizable: true,
          headerFilter:false,
          sorter:"number",
        };
      } else if(colName === "Specialty"){
        return {
          title: colName,
          field: colName,
          resizable: true,
          headerFilter:"input",
          sorter:"string"
        };
      } else if(colName === "Preview"){
        return {
          title: colName,
          field: colName,
          resizable:true,
          sorter:false,
          formatter:function(cell){
            const value = cell.getValue();
            if(!value) return "";
            return `<span class="preview-hover">Hover<img src="${value}" alt="Preview"></span>`;
          }
        };
      } else if(colName === "Link"){
        return {
          title: colName,
          field: colName,
          resizable:true,
          sorter:"string",
          formatter:"link",
          formatterParams:{labelField:colName, urlField:colName, target:"_blank"}
        };
      } else {
        return {
          title: colName,
          field: colName,
          resizable:true,
          sorter:"string"
        };
      }
    });

    const table = new Tabulator("#creator-table", {
      data: data,
      layout:"fitDataTable",      // columns auto-fit content
      columns: columns,
      movableColumns: true,       // drag to reorder
      height:"700px",
      reactiveData: true,
      initialSort:[{column:"Rank", dir:"asc"}],
    });

    // Hover image preview functionality
    const container = document.querySelector("#creator-table");
    container.addEventListener("mouseover", function(e) {
      const target = e.target.closest(".preview-hover");
      if(target){
        const img = target.querySelector("img");
        if(img) img.style.display = "block";
      }
    });
    container.addEventListener("mouseout", function(e) {
      const target = e.target.closest(".preview-hover");
      if(target){
        const img = target.querySelector("img");
        if(img) img.style.display = "none";
      }
    });
  }
});
</script>

</body>
</html>
